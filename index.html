
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>OSPI — Purchase Intent Predictor (Kaggle)</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link rel="stylesheet" href="./styles.css?v=1">
</head>
<body>
<div class="wrap">
  <h1>Online Shoppers Purchasing Intention — Live Demo</h1>
  <p class="sub">Runs a PyTorch MLP (ONNX) in your browser with onnxruntime-web. Kaggle-safe (no fetch for model/JSON).</p>

  <!-- About / How it works -->
  <div class="card" id="about">
    <details open>
      <summary>About this demo</summary>
      <p>
        This page estimates the probability that a web session ends in a purchase.
        It uses a PyTorch MLP exported to <b>ONNX</b> and runs fully in your browser with <b>onnxruntime-web</b>.
        No data is sent to any server.
      </p>

      <div class="grid about-grid">
        <div class="card card-compact">
          <b>Dataset</b><br>
          UCI Online Shoppers Purchasing Intention (12,330 sessions, ~15.5% positive).
        </div>
        <div class="card card-compact">
          <b>Split</b><br>
          Stratified 70% train / 15% validation / 15% test. Threshold tuned on VAL.
        </div>
        <div class="card card-compact">
          <b>Best model</b><br>
          MLP (128-64-32) with class-imbalance weighting; exported to ONNX.
        </div>
        <div class="card card-compact">
          <b>Test performance</b><br>
          F1(positive) ≈ 0.65 • Macro-F1 ≈ 0.79 • ROC-AUC ≈ 0.92 • PR-AUC ≈ 0.70 • Tuned threshold ≈ 0.67
        </div>
      </div>

      <h4 style="margin:14px 0 6px;">How to use</h4>
      <ul style="margin:0; padding-left:18px;">
        <li>Use the inputs to describe a browsing session (e.g., pages viewed, durations, month, visitor type, weekend).</li>
        <li>Click <b>Predict</b> to get the purchase probability and the class label.</li>
        <li>Adjust the <b>Threshold</b> to see how the decision boundary changes (higher = stricter).</li>
        <li>Try the <b>presets</b> for quick examples (high-intent, bounce, researching).</li>
      </ul>

      <h4 style="margin:14px 0 6px;">Notes</h4>
      <ul style="margin:0; padding-left:18px;">
        <li>Important drivers in this model (by permutation): <i>PageValues</i>, <i>Month</i>, <i>ProductRelated</i>/<i>Duration</i>, and <i>ExitRates</i>.</li>
        <li>Imbalanced data: the model optimizes for F1 of the purchase class; accuracy alone can be misleading.</li>
      </ul>
    </details>
  </div>

  <!-- Presets -->
  <div class="card preset-card">
    <div class="row">
      <label for="exampleSelect" class="muted">Try a preset:</label>
      <select id="exampleSelect" style="min-width:280px;">
        <option value="purchase_hi">High-intent Purchase (Returning, Nov, high value)</option>
        <option value="no_purchase_bounce">No-purchase Bounce (New visitor, high exit)</option>
        <option value="research_maybe">Researching / Maybe (info heavy, moderate)</option>
      </select>
      <button id="loadBtn" class="btn btn-secondary">Load</button>
      <button id="loadPredictBtn" class="btn btn-primary">Load & Predict</button>
      <button id="resetBtn" class="btn btn-secondary">Reset to defaults</button>
      <span class="muted">Threshold:
        <input id="thrInput" type="number" step="0.01" min="0" max="1" style="width:76px;margin-left:6px;">
      </span>
    </div>
  </div>

  <div class="grid" id="inputs"></div>

  <div class="card">
    <div class="actions">
      <button id="predictBtn" class="btn btn-primary">Predict</button>
    </div>
    <div class="result">
      <div class="prob">Probability of Purchase: <b id="prob">–</b></div>
      <div>Predicted Class: <b id="cls">–</b></div>
      <div id="err"></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.19.2/dist/ort.min.js"></script>
<script src="./app.js?v=3"></script>
</body>
</html>
